# 授课方法和体系

授课方式：

* 应用场景 -> C语言知识点 -> 剖析原理 -> 分析实现步骤 -> 代码实现及讲解
  * 例如：提出一个实际需求 -> 传统方法解决 -> 分析传统方法的缺点 -> C语言知识(结构体基本原理及快速入门案例) -> 注意事项和细节、使用陷阱等（考试和做项目时需注意的点） -> 应用案例

* 穿插讲解C语言考试真题《全国计算机二级C语言考试》——National Computer Rank Examination(合格、优秀、良好)
* 掌握C语言本质，通过二级考试，独立完成难度不大的C项目、C游戏。
* 深入到位地掌握知识

# C语言内容介绍

几个经典程序：

* 坦克大战
* 连连看
* 猴子吃水果

经典管理系统：

* 家庭记账软件
* 客户关系管理系统

> 同时参考配套《真题讲解》视频

C语言学习方向：

* C语言开发工程师（服务器）
* 嵌入式软件开发（C）
* Linux C/C++ 软件工程师

C语言知识体系：

* 见知识体系图

# C语言程序基础

## 〇、前置介绍

### 0.1 什么是程序

**程序**：为了让计算机执行某些操作或解决某个问题而编写的**一系列有序指令的集合**。

* 老板让秘书做以下事情：① 做会议记录 ② 给相关部门发邮件 ③ 传真会议记录

* 秘书按①②③按顺序执行完毕。

计算机程序：逐条执行指令。

下面尝试写第一个C语言程序：

```c
#include<stdio.h>
void main(){
  printf("做会议记录");
  printf("给相关部门发邮件");
  printf("传真会议记录");
}
//编译  执行
```

### 0.2 C语言发展历程

**C语言之父、Unix之父：**丹尼斯·里奇（Dennis Ritchie）。

20世纪60年代，丹尼斯·里奇和肯·汤普逊参与了贝尔实验室[Multics](https://zh.wikipedia.org/wiki/Multics)系统的开发。然而之后不久贝尔实验室又撤出了Multics计划，于是汤普逊找到了一台[PDP-7](https://zh.wikipedia.org/wiki/PDP-7)机器，从头开始开发应用程序和操作系统（主要用汇编语言）。在此期间，丹尼斯·里奇和汤普逊也带领团队进行系统的开发工作。1970年，[布莱恩·柯林汉](https://zh.wikipedia.org/wiki/布萊恩·柯林漢)建议把系统命名为“Unix”，与“Multics”名字相对。在完成Unix系统开发的基本工作之后，汤普逊觉得Unix系统需要一个系统级的编程语言，便创造了[B语言](https://zh.wikipedia.org/wiki/B語言)。后来丹尼斯·里奇则在B语言的基础上创造了[C语言](https://zh.wikipedia.org/wiki/C語言)。

从此，C语言成为了编写操作系统的主要语言。

**影响：**C语言深刻影响了后来的很多编程语言，比如C++、C#、Java、PHP、JavaScript、Perl、LPC、Unix的C shell等。

C语言是其他编程语言的核心基础。

**C语言标准发展：**

![image-20210123234137421](C_Programming_Sgg.assets/image-20210123234137421.png)

* C语言的两个重要版本：C89，C99。

**C语言的特点：**

* 代码级别的跨平台。由于标准的存在，使得几乎同一的C代码可用于多种操作系统，多种机型。
* 允许直接访问物理地址，对硬件进行操作。C语言可以直接访问物理地址，所以可以直接对硬件进行操作。因此它即具有高级语言的功能，又有低级语言的许多功能。C语言可以用来写系统软件——比如操作系统、数据库、杀毒软件、防火墙、驱动、服务器程序等等。
* C语言是一个有结构化程序设计、具有变量作用域（variable scope）以及递归功能的过程式语言。

* C语言传递参数可以是值传递（pass by value），也可以传递指针（a pointer passed by value，传的是地址）。
* C语言中，没有对象，不同的变量类型可以用结构体（struct）组合在一起。
* 预编译处理（preprocessor）生成目标代码质量高，程序执行效率高。

**C语言开发工具：**

1. Microsoft Visual C++（6.0版本）
2. Microsoft Visual Studio
3. Dev C++ code::Blocks
4. High C、Turb C、gcc、C-Free和Win-T等

* 2018年3月起，全国二级C语言平台更改为VC++2010 Express版。

* Visual C++ 2010 Express是一款IDE（集成开发程序）。安装完开发工具，还要安装C的运行时组件。

### 0.3 教学术语

* 函数，又称为方法
* 程序控制台，也成为终端，计算机最原始的样子。

参考阅读：

《编码》。从零到一创建一台电脑，帮助你理解计算机的底层工作原理。



参考视频：



### 0.3.1 C语言快速入门

1. 创建一个空项目（VC2010以项目为单位管理我们的代码）
2. 将C代码写入名为xxx.c的C文件中。
3. 编译执行代码。

```c
//1.1 新建项目 -> 空项目 -> 修改项目名称、保存项目路径
//1.2 右键选中源文件 -> 添加新建项 -> C++文件（修改文件名为hello） -> 把hello.cpp文件重命名为hello.c
#include <stdio.h>
void main(){  //①
  printf("hey hello;");  //②
}
```

① 任何一个程序的入口，就是它的main函数。即程序代码的执行，从main函数开始。

② printf()函数存放在一个头文件<stdio.h>中，所以要在程序开头引入此头文件(`#include <stdio.h>`)才可以使用这个函数。

③ 设置字体：工具->选项->字体和颜色：14，粗体。

④ 设置执行：

![image-20210124120450824](C_Programming_Sgg.assets/image-20210124120450824.png)

![image-20210124120545683](C_Programming_Sgg.assets/image-20210124120545683.png)

* 代码中加入一行：`getchar();` 让窗口停留。 

### 0.3.2 C程序项目运行机制

1. 编写源代码：即编写hello.c文件。
2. 编译：编译hello.c文件为hello.obj文件（此步骤在计算机底层执行）。
3. 链接：将hello.obj文件＋库文件生成MyProject01.exe可执行文件（此步骤在计算机底层执行）。
4. 运行：执行.exe文件，得到运行结果。

![image-20210124122259577](C_Programming_Sgg.assets/image-20210124122259577.png)

* cl.exe和link.exe存放在VC2010目录下的VC/bin文件夹。

> 知识清单：
>
> * 要知道C安装的路径
> * 要知道IDE存放的路径
> * 要知道项目路径
> * 要知道C语言的运行机制
>
> 学习C语言的注意事项：
>
> * 先明白逻辑，再用IDE
> * 所有讲过的操作一定要动手执行，学习编程是一件很容易有幻觉的事情。工科，说到底，是手艺，是熟练度，是肌肉记忆。

#### 编译：

编译是将源文件通过编译器编译为.obj文件的过程。

如果程序没有错误error，没有警告warning，那么Debug目录下会出现对应的`文件名.obj`文件，即目标文件。

#### 链接：

将.obj文件通过链接所需的c库文件来转为.exe文件。

如果程序没有error, warning, 那么Debug目录下会出现`项目名.exe`文件。

库文件是用来支持我们C程序正常执行的底层文件，比如<stdio.h> <stdlib.h>等，它们中分别包含有我们经常需要使用的printf()方法和system()方法。

.exe文件比.obj文件大很多。

#### 运行：

双击.exe文件即可运行程序，此过程称为执行程序。

#### C程序开发注意事项：

* 修改：每一次修改.c文件后，都需要重新编译.c文件，重新生成一系列对应.obj文件和.exe文件，再双击执行，修改才能生效。

* C程序的主体结构：

  ```c
  //1. 引入头文件
  # include <stdio.h>
  //2. 程序执行入口：main()方法。void表示方法返回类型，main函数没有返回值。
  void main(){
    //语句1
    //语句2
    ...
  }
  ```

  * { ... }包含的内容，为函数体（方法体）。

* C程序的源文件以.c为扩展名

* C程序的执行入口是main()方法

* C程序严格区分大小写

  * main≠Main

* C程序由一条条语句构成，每个语句以`;`结束（英文字符）

* 大括号都是成对出现，缺一不可

### 0.4 C语言转义符

* `\t`  制表符：把每个元素当做表格元素来对齐。预留8个字符的显示宽度。
* `\n` 换行符：光标移动到下一行
* `\\` \符号
* `\"` "符号
* `\'` '符号
* `\r` 回车符：光标回到本行行首

> word中的enter回车其实是\n\r结合。

例子：`printf("张无忌赵敏周/r芷若小昭")` 会输出什么？

* 芷若小昭敏周

> 课堂练习：
>
> 请输出![image-20210124131031583](C_Programming_Sgg.assets/image-20210124131031583.png)

### 0.5 常见问题及解决方法

1. fatal error LNK1104：无法打开文件
   * 关闭已打开的控制台程序，然后重新编译运行
2. 语法错误：缺少";"
   * 仔细检查代码中的;是否有缺失。可以根据错误提示信息找到错误所在行数。

> 最容易犯的错误就是语法错误。程序编写过程中，请注意`;`  `{ }`  `""` 字母大小写、单词拼写错误、中英文符号混用等语法错误。可以参考报错信息来定位错误所在位置。

### 0.6 代码注释

代码注释是对程序代码的文字性解释。用于提高程序的可读性。

* 单行注释：//单行注释balabala

* 多行注释：

  ```c
  /* 多行注释balabala
  	abababababa
  	lilili
  */
  int a = 3; //这是一个单行注释
  ...
  ```

  * 注释不会被编译，所以注释内容不会被执行
  * 多行注释嵌套使用会产生混乱，所以不建议这样使用

> 设置编辑器添加注释快捷键

注释风格：

* 注释函数中的某个语句时，用单行注释
* 注释一个完整的函数时，用多行注释

代码缩进：

​		为了更好地呈现代码，提高代码的可读性，代码不要黏在一起书写，而要分行错落，利用tab和shift+tab来回调整代码的缩进距离，使代码的整体风格清晰可读。

* tab：增加缩进，代码整体向右移动
* shift+tab：减少缩进，代码整体向左移动

* 在运算符的左右增加空格，便于阅读代码。

> 设置代码布局快捷键

* 次行风格 vs 行尾风格

### 0.7 C语言标准库

C语言标准库是一系列C内置的函数、常量和头文件。比如<stdio.h> <stdlib.h> <math.h>等等。

这些是C语言设计者已写好的方法库，我们可以直接调用，而不用自己亲手去设计这些方法。使用前需要文件引入。

## 一、 核心基础

### 1.1 什么是变量

1. **一个程序就是一个世界。**我们的世界中有很多不同的事物。

2. 在程序中，我们用不同的变量来表示不同的事物。
3. **变量是程序的基本组成单位。**

```c
void main(){
	int a = 3;
  int b = 5;
  b = 99;
  printf("a=%d\n",a);
  printf("b=%d\n",b);
  getchar();
}
```

![image-20210124135207000](C_Programming_Sgg.assets/image-20210124135207000.png)

* 变量来源于数学，是计算机语言中能储存计算结果或能表示值的抽象概念。变量可以通过变量名访问。在指令式语言中，变量通常是可变的；——百度百科
* 在程序设计中，变量（英语：Variable，scalar）是指一个包含部分已知或未知数值或信息（即一个值）之存储地址，以及相对应之符号名称（识别字）。通常使用变量名称引用存储值；将名称和内容分开能让被使用的名称独立于所表示的精确消息之外。——维基百科

### 1.1.2 变量的使用

1. 声明变量：int num;
2. 赋值：num = 60;
3. 使用：printf("%d",num);

* 声明＋赋值：int num = 60;

数据类型：

```c
int num = 1;//整数
double b = 2.3;//小数
char a = 'A';//字符
char name[] = "字符串";
printf("num=%d,b=%.2f,a=%c,name=%s",num,b,a,name);
```

### 1.1.3 变量使用的注意事项

1. 变量表示内存中的一个存储区域（不同的数据类型，占用空间大小不一样），用于存储一个值。
2. 该区域有自己的名(变量名)和类型(数据类型)
3. 变量必须先声明，后使用
4. 该区域中所存储的数据（数值）可以在同一类范围内不断变化
   * `int a = 3;  a=3.2`  会产生warning：double到int可能丢失数据

5. 变量在同一个作用域内不能重名
   * `int num = 3; int num = 9;` 会产生error：num不能重新定义（多次初始化）
6. 变量三要素（数据类型、变量名、值）

### 1.2 变量的数据类型

![img](C_Programming_Sgg.assets/1-120205162A4H8.jpg)

注意：

1. C语言的基本类型中没有字符串类型，而是用字符数组表示字符串
2. 在不同系统上，部分数据类型字节大小不同（下面具体解释）

#### C语言的基本类型概括：

整型：

1. short int
2. unsigned short int
3. int
4. unsigned int
5. long int
6. unsigned long int
7. （C99）long long int
8. （C99）unsigned long long int

浮点型：

1. float
2. double
3. long double
4. （C99）float_Complex 复数类型
5. （C99）double_Complex
6. （C99）long double_Complex

字符型：

1. char

### 1.2.1 整数

C语言中的整数有6种（此外C99标准又增加了2种）。它们的作用都只是用于存储一个整数。但是由于数值的大小不同，出于合理分配计算机内存的考虑，C语言的整数类型细分成了6种不同类型，用来方便不同运算量级的程序使用。

C语言整型的尺寸因系统的CPU位数不同而不同。古老的16位操作系统和现代的64位操作系统在内存分配上有所不同，这导致了它们在运算范围和能力上有巨大的差异。但是不论是哪一种操作系统，C语言整型的内存分配必将遵循如下规则：

* short <= int
* int <= long
* 即，不论在何种系统中，short所占的内存必然少于或等于int，int也少于或等于long。

一般情况下，我们最常使用int类型来作为整数类型（它的取值范围在32位和64位系统中是-2147483648 ~ 2147483647），如果需要表示大数则使用long类型，如果要节省内存且数值在对应范围之内，则使用short类型。

同时需要注意的是，我们所介绍的各种整型所占内存和数值范围（包括下面三个表格所包含的信息），是C标准中所规定的，但C标准并不是强制实现的，且因为编译器的不同而不同，所以不同的系统在实现中仍有微小差异。如果想要查看整数类型的实际范围，可以检查<limits.h>头文件，其中定义了表示每种整数类型的最大值和最小值的宏。

* 16位机的整数类型

  |      类型      | 比特数(bits) | 字节数(bytes) |   最小值    |   最大值   |
  | :------------: | :----------: | :-----------: | :---------: | :--------: |
  |     short      |      16      |       2       |   -32768    |   32767    |
  | unsigned short |      16      |       2       |      0      |   65535    |
  |      int       |      16      |       2       |   -32768    |   32767    |
  |  unsigned int  |      16      |       2       |      0      |   65535    |
  |      long      |      32      |       4       | -2147483648 | 2147483647 |
  | unsigned long  |      32      |       4       |      0      | 4294967295 |

* 32位机的整数类型

  |      类型      | 比特数(bits) | 字节数(bytes) |   最小值    |   最大值   |
  | :------------: | :----------: | :-----------: | :---------: | :--------: |
  |     short      |      16      |       2       |   -32768    |   32767    |
  | unsigned short |      16      |       2       |      0      |   65535    |
  |      int       |      32      |       4       | -2147483648 | 2147483647 |
  |  unsigned int  |      32      |       4       |      0      | 4294967295 |
  |      long      |      32      |       4       | -2147483648 | 2147483647 |
  | unsigned long  |      32      |       4       |      0      | 4294967295 |

* 64位机的整数类型

  |      类型      | 比特数(bits) | 字节数(bytes) |           最小值           |           最大值           |
  | :------------: | :----------: | :-----------: | :------------------------: | :------------------------: |
  |     short      |      16      |       2       |           -32768           |           32767            |
  | unsigned short |      16      |       2       |             0              |           65535            |
  |      int       |      32      |       4       |        -2147483648         |         2147483647         |
  |  unsigned int  |      32      |       4       |             0              |         4294967295         |
  |      long      |      64      |       8       | -9 223 372 036 854 775 808 | 9 223 372 036 854 775 807  |
  | unsigned long  |      64      |       8       |             0              | 18 446 744 073 709 551 615 |

> 补充知识：（帮助理解上图中的字节数和取值范围关系）
>
> ##### 一、计算机数据存储单位：
>
> 1. bit 比特：表示0或1
> 2. byte 字节 = 8 bits
> 3. M 兆 = 1024 bytes
>
> 补充知识：计算机底层逻辑原理
>
> * 操作系统是什么
> * 计算机如何实现逻辑运算
>
> ##### 二、有符号整数 VS 无符号整数：
>
> 在计算机底层原理中，数字的存储用二进制比特位来表示：
>
> 例如：`short int a = 3;`
>
> * 在计算机内存中，系统给short int类型的变量a开辟了2个字节(16bits)的存储空间来存放它的数值。（16位、32位、64位系统）
> * 所以变量a中所存的值3，在内存中表示为：0000 0000 0000 0011。
> * 在本例中，其最左位为符号位：
>   * 有符号的整数，其最左位为0表示正数，为1表示负数。所以short int的取值范围是-2^15 ~ 2^15-1，即-32768~32767，二进制表示为：1000 0000 0000 0000 ~ 0111 1111 1111 1111
>     * -32767的二进制数为1111 1111 1111 1111
>     * -32768的二进制数为1000 0000 0000 0000
>   * 无符号的整数，其最左位也是数值的一部分。所以unsigned short int的取值范围是0 ~ 2^16-1，即0~65535，二进制表示为：0000 0000 0000 0000 ~ 1111 1111 1111 1111
>
> 默认情况下，C语言的整型变量都是有符号的，即最左位保留为符号位。若要告知编译器变量没有符号位，则需要使用unsigned来声明。
>
> ##### 三、思考：
>
> ```c
> short a = 3;
> int b = 3;
> ```
>
> 在内存中的有何不同？
>
> * 有符号16bits
> * 有符号32bits

整型使用细节：

* 如果没有特殊说明，我们一般所说的int是signed int，即带符号的int类型。
* unsigned int不一定会被所有操作系统识别，以上定义只是标准定义，并不是严格强制执行的。
* 在C语言中，数据类型所占用的字节数（存储值的范围大小）与操作系统、系统位数、编译器有关。目前最通用的是64位操作系统。实际工作中，C程序通常运行在linux/unix操作系统下。二级考试用的是windows系统。

* 操作系统编译器和数据类型所占字节数的关系图

  <img src="C_Programming_Sgg.assets/32-64.jpg" style="zoom:70%;" />

  * Windows 32位和64位编译结果一样。

### 1.2.2 浮点型

浮点型可以表示一个小数。例如：12.34，0.07等等。

浮点型的分类：

|  类型  | 比特数(bits) | 字节数(bytes) |    最小值    | 最大值 |   精度   |
| :----: | :----------: | :-----------: | :----------: | :----: | :------: |
| float  |      32      |       4       | 1.176*10^-38 |  3.4   | 6位小数  |
| double |      64      |       8       |              |        | 15位小数 |

